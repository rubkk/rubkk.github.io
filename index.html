<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPBãƒ¯ãƒ¼ãƒ‰ã‚¦ãƒ«ãƒ•</title>
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'M PLUS Rounded 1c', sans-serif; 
            text-align: center; 
            padding: 50px; 
            background: linear-gradient(to bottom, #f0f8ff, #e0f7fa); 
            font-size: 20px; 
            color: #333;
            position: relative;
            min-height: 100vh;
            padding-bottom: 150px;
        }
        h1 { font-size: 48px; margin-bottom: 30px; }
        input, button, select { 
            padding: 15px; 
            margin: 15px; 
            font-size: 22px; 
            border-radius: 10px; 
            border: 2px solid #aaa;
            background: white;
        }
        #setup { 
            margin: 40px auto; 
            max-width: 600px; 
            background: #fff; 
            padding: 40px; 
            border-radius: 20px; 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1); 
        }
        #timer { 
            font-size: 52px; 
            margin: 60px; 
            position: relative; 
            z-index: 101; 
            background: rgba(255,255,255,0.8); 
            padding: 10px 20px; 
            border-radius: 15px; 
        }
        #discussionTimer { 
            font-size: 100px; 
            font-weight: bold; 
            margin: 40px auto; 
            padding: 20px; 
            background: rgba(255,255,255,0.9); 
            border-radius: 30px; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.3); 
            max-width: 500px; 
            text-shadow: 4px 4px 10px #aaa; 
            position: relative;
            z-index: 50;
        }
        #result { 
            font-size: 28px; 
            margin: 60px auto; 
            max-width: 800px; 
            padding: 40px; 
            background: white; 
            border: 5px dashed #888; 
            border-radius: 25px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); 
        }
        .hidden { display: none !important; }
        #guide { 
            font-size: 26px; 
            margin: 40px; 
            font-weight: bold; 
            color: #444; 
            position: relative; 
            z-index: 1; 
        }
        #voteSection, #resultSection, #reversalSection { 
            font-size: 24px; 
            margin: 40px auto; 
            max-width: 600px; 
            padding: 30px; 
            background: #e8f4f8; 
            border-radius: 20px; 
            box-shadow: 0 8px 15px rgba(0,0,0,0.1); 
        }
        .win { color: #0a0; font-size: 52px; animation: bounce 1.5s infinite; }
        .lose { color: #c00; font-size: 52px; animation: shake 0.8s; }
        .reversal-win { color: #c00; font-size: 48px; animation: bounce 1.5s infinite; } /* ã‚¦ãƒ«ãƒ•é€†è»¢å‹åˆ©ã¯èµ¤ */
        #nextGameBtn, #reversalBtn { 
            padding: 30px 70px; 
            font-size: 40px; 
            margin: 80px auto; 
            background: linear-gradient(#4CAF50, #388e3c); 
            color: white; 
            border: none; 
            border-radius: 40px; 
            cursor: pointer; 
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            position: relative;
            z-index: 10;
        }
        #reversalBtn { background: linear-gradient(#ff9800, #f57c00); }
        #nextGameBtn:hover, #reversalBtn:hover { transform: scale(1.1); }
        #revealBtn {
            padding: 16px 45px;
            font-size: 30px;
            background: linear-gradient(#ff6b6b, #ee5a52);
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 100;
        }
        #revealBtn:hover { 
            transform: translateX(-50%) scale(1.1); 
            background: #ff5252; 
        }
        img.game-img { 
            max-width: 400px; 
            border-radius: 25px; 
            box-shadow: 0 10px 20px rgba(0,0,0,0.3); 
            margin: 30px auto; 
            display: block; 
        }
        @keyframes bounce { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-40px); } }
        @keyframes shake { 0%,100% { transform: translateX(0); } 25% { transform: translateX(-20px); } 75% { transform: translateX(20px); } }
    </style>
</head>
<body>
    <h1>ğŸº BPBãƒ¯ãƒ¼ãƒ‰ã‚¦ãƒ«ãƒ• ğŸ‰</h1>

    <div id="setup">
        <p>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°: <input type="number" id="players" value="5" min="3"></p>
        <p>ã‚¦ãƒ«ãƒ•æ•°: <input type="number" id="wolves" value="1" min="1"></p>
        <p>ã‚ãªãŸã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç•ªå·: <input type="number" id="myNumber" value="1" min="1"></p>
        <button id="startBtn" onclick="startGame()">ã‚²ãƒ¼ãƒ é–‹å§‹ï¼ ğŸš€</button>
    </div>

    <div id="guide" class="hidden">
        <p>é€²è¡Œå½¹ãŒæ™‚é–“ã‚’æŒ‡å®šã—ã¾ã™ã®ã§ã€<br>ãã®æ™‚é–“ã«ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ï¼</p>
        <p><strong>Â±2ç§’ä»¥å†…</strong>ã«æŠ¼ã›ã°å…¨å“¡åŒã˜ãŠé¡Œã«ãªã‚Šã¾ã™</p>
    </div>

    <div id="timer" class="hidden">å¾…æ©Ÿä¸­â€¦</div>

    <button id="revealBtn" class="hidden" onclick="revealWord()">ä»Šï¼ãŠé¡Œã‚’è¦‹ã‚‹ ğŸ”¥</button>

    <div id="result" class="hidden"></div>

    <div id="discussionTimer" class="hidden">3:00</div>

    <div id="voteSection" class="hidden">
        <h2>æŠ•ç¥¨ãƒ•ã‚§ãƒ¼ã‚º</h2>
        <p>èª°ã‚’è¿½æ”¾ç¥¨ã«å…¥ã‚Œã¾ã™ã‹ï¼Ÿ</p>
        <select id="voteTarget"></select>
        <br>
        <button onclick="submitVote()">æŠ•ç¥¨ã™ã‚‹</button>
        <p id="myVote"></p>
    </div>

    <div id="resultSection" class="hidden">
        <h2>çµæœç™ºè¡¨ï¼ˆé€²è¡Œå½¹æ“ä½œï¼‰</h2>
        <p>å£é ­é›†è¨ˆå¾Œã®è¿½æ”¾è€…ç•ªå·ã‚’å…¥åŠ›:</p>
        <input type="number" id="banished" min="1" placeholder="ä¾‹: 3">
        <button onclick="showFinalResult()">çµæœã‚’è¦‹ã‚‹</button>
    </div>

    <div id="reversalSection" class="hidden">
        <h2>é€†è»¢ãƒãƒ£ãƒ¬ãƒ³ã‚¸ï¼</h2>
        <p>ã‚¦ãƒ«ãƒ•å´ã¯å¤šæ•°æ´¾ã®ãŠé¡Œã‚’å½“ã¦ã¦ãã ã•ã„ï¼</p>
        <input type="text" id="guessWord" placeholder="å¤šæ•°æ´¾ã®ãŠé¡Œã‚’å…¥åŠ›">
        <button onclick="checkReversal()">å›ç­”ã™ã‚‹</button>
    </div>

    <button id="reversalBtn" class="hidden" onclick="startReversal()">é€†è»¢ãƒãƒ£ãƒ¬ãƒ³ã‚¸é–‹å§‹ï¼</button>

    <button id="nextGameBtn" class="hidden" onclick="nextGame()">æ¬¡ã®ã‚²ãƒ¼ãƒ ã¸ ğŸŠ</button>

    <!-- åŠ¹æœéŸ³ -->
    <audio id="victorySound" src="https://freesound.org/data/previews/466/466133_9033262-lq.mp3"></audio>
    <audio id="loseSound" src="https://freesound.org/data/previews/73/73581_634166-lq.mp3"></audio>
    <audio id="beepSound" src="https://cdn.pixabay.com/download/audio/2022/05/24/audio_8e2e6f7d6d.mp3?filename=beep-6269.mp3"></audio>

    <script>
        const wordGroups = [
            { group: "ãƒãƒƒã‚°", words: ["å®ˆè­·ã®ãƒãƒ³ãƒ‰ãƒãƒƒã‚°", "ã‚¦ã‚¨ã‚¹ãƒˆãƒãƒ¼ãƒ", "é©ã®ã‚«ãƒãƒ³", "ã‚¹ã‚¿ãƒŸãƒŠãƒãƒƒã‚°", "ãƒãƒ¼ã‚·ãƒ§ãƒ³ãƒ™ãƒ«ãƒˆ"] },
            { group: "åºç›¤æ­¦å™¨", words: ["æœ¨ã®å‰£", "ãƒ•ãƒ©ã‚¤ãƒ‘ãƒ³", "ãƒ›ã‚¦ã‚­"] },
            { group: "ãƒˆãƒ¬ãƒ¼ãƒ‰", words: ["ä¼šå“¡ã‚«ãƒ¼ãƒ‰", "ãƒ—ãƒ©ãƒãƒŠä¼šå“¡ã‚«ãƒ¼ãƒ‰", "å¤©ç§¤", "å¾“æ¥­å“¡ã®åˆ¶æœ", "ãƒã‚§ã‚¹ãƒˆãƒŠãƒƒãƒˆå›"] },
            { group: "ã‚°ãƒ¬ã‚½", words: ["ã‚ã¾ã‚Šã«ã‚‚å¤§ãã™ãã‚‹ãƒ–ãƒ©ãƒƒãƒ‰ã‚½ãƒ¼ãƒ³", "ãƒ’ãƒ¼ãƒˆã‚°ãƒ¬ãƒ¼ãƒˆã‚½ãƒ¼ãƒ‰", "ç ´æ»…ã®ã‚°ãƒ¬ãƒ¼ãƒˆã‚½ãƒ¼ãƒ‰", "ã‚°ãƒ¬ãƒ¼ãƒˆã‚½ãƒ¼ãƒ‰"] },
            { group: "ã©ã‚“ãã‚Š", words: ["ãƒ‰ãƒ³ã‚°ãƒªã®é¦–é£¾ã‚Š", "é’ã‚»ãƒ¼ã‚¸ã®é¦–é£¾ã‚Š", "èµ¤ãƒ©ãƒ³ã®é¦–é£¾ã‚Š", "ç™½ãƒ¦ãƒªã®é¦–é£¾ã‚Š"] },
            { group: "å¼±ã„åˆæœŸã‚«ãƒãƒ³", words: ["è£ç¸«ã‚»ãƒƒãƒˆ", "å­¦è€…ã®ã‚«ãƒãƒ³", "ãŸãç«å°", "ä¾¿åˆ©ãƒãƒ¼ãƒ","æ£ºå‹ãƒãƒƒã‚°"] },
            { group: "å¼·ã„åˆæœŸã‚«ãƒãƒ³", words: ["æ–½ã—è¢‹", "ãƒ‘ã‚ºãƒ«ãƒœãƒƒã‚¯ã‚¹", "ä¾›ç‰©çš¿", "ä¾¿åˆ©ãƒãƒ¼ãƒ", "ãƒ¬ãƒªãƒƒã‚¯ã‚±ãƒ¼ã‚¹", "ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼ã®ã‚«ãƒãƒ³", "é¶´ç¹”ã‚Šãƒã‚¹ã‚±ãƒƒãƒˆ"] },
            { group: "å‹•ç‰©", words: ["ã‚«ãƒ¡", "ãƒ˜ãƒ“", "ã‚«ãƒ©ã‚¹", "ãƒªã‚¹", "ãƒãƒªãƒã‚ºãƒŸ", "ãƒã‚ºãƒŸ"] },
             { group: "é£Ÿã¹ç‰©", words: ["ãƒãƒŠãƒŠ", "ãƒ‹ãƒ³ãƒ‹ã‚¯", "ãƒ–ãƒ«ãƒ¼ãƒ™ãƒªãƒ¼", "ãƒ‘ã‚¤ãƒŠãƒƒãƒ—ãƒ«", "ã‚¹ãƒãƒ¼ã‚±ãƒ¼ã‚­", "ãƒ‘ãƒ³ãƒ—ã‚­ãƒ³", "ãƒ‹ãƒ³ã‚¸ãƒ³", "ã‚¨ã‚µã®ç››ã‚Šåˆã‚ã›", "ãƒãƒ¡ãƒ„ãƒ€ã‚±", "ãƒˆã‚¦ã‚¬ãƒ©ã‚·", "ãƒãƒ¼ã‚º", "ãƒ–ãƒ­ãƒƒã‚³ãƒªãƒ¼", "ãƒˆã‚¦ã‚¬ãƒ©ã‚·", "ã‚«ãƒƒãƒ—ã‚±ãƒ¼ã‚­", "ãƒ™ãƒ‹ãƒ†ãƒ³ã‚°ãƒ€ã‚±"] },
            { group: "ãƒ€ã‚¬ãƒ¼", words: ["ãƒ–ãƒ©ãƒƒãƒ‡ã‚£ãƒ€ã‚¬ãƒ¼", "ãƒ€ã‚¬ãƒ¼", "ãƒã‚¤ã‚ºãƒ³ãƒ€ã‚¬ãƒ¼", , "ã‚´ãƒ¼ã‚¹ãƒˆãƒ€ã‚¬ãƒ¼", "å‘ªã‚ã‚Œã—ãƒ€ã‚¬ãƒ¼", "ãƒ’ãƒ¼ãƒˆãƒ€ã‚¬ãƒ¼", "ãƒ€ã‚¬ãƒ¼ãƒ©ãƒ³"] },
            { group: "é‡‘ç­–", words: ["å¯Œã®ãƒ–ã‚¿ã¡ã‚ƒã‚“", "æŠ•è³‡æ©Ÿä¼š", "ãƒ–ã‚¿ã¡ã‚ƒã‚“è²¯é‡‘ç®±", "å¯Œã®å®ç®±"] },
            { group: "å¸è¡€", words: ["ãƒ–ãƒ©ãƒƒãƒ‡ã‚£ãƒ€ã‚¬ãƒ¼", "é»’ã®ãƒŠã‚¤ãƒˆ", "ãƒˆãƒ©ã®ãƒ«ãƒ¼ãƒ³", "æ¥µå¸è¡€ã®ãƒãƒ¼ã‚·ãƒ§ãƒ³", "å¤œé—‡ã®ãƒ˜ã‚¢ã‚³ãƒ¼ãƒ ", "èµ¤ãƒ©ãƒ³ã®é¦–é£¾ã‚Š", "ãƒ–ãƒ©ãƒƒãƒ‰ã‚½ãƒ¼ãƒ³", "ãƒ–ãƒ©ãƒƒãƒ‡ã‚£ãƒ»ã‚¹ãƒ©ãƒãƒ¼ãƒˆ", "å¸è¡€ã‚°ãƒ­ãƒ¼ãƒ–", "ãƒ•ãƒ­ã‚¹ãƒˆãƒã‚¤ãƒˆ", "è¡€ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ", "è¡€ã®å¤§éŒ", "é£¢ãˆãŸã‚‹å‰£", "å¸è¡€ã®ãƒãƒ¼ã‚·ãƒ§ãƒ³"] },
            { group: "ãƒãƒ¼ã‚·ãƒ§ãƒ³", words: ["æ¥µå¸è¡€ã®ãƒãƒ¼ã‚·ãƒ§ãƒ³", "å‡¶æ‚ªé¬¼ã®ãƒ•ãƒ©ã‚¹ã‚³", "æ‚ªé¬¼ã®ãƒ•ãƒ©ã‚¹ã‚³", "ãƒã‚¤ãƒãƒŠãƒãƒ¼ã‚·ãƒ§ãƒ³", "å¼·ç–«æ¯’ã®ãƒ•ãƒ©ã‚¹ã‚³", "å¸è¡€ã®ãƒãƒ¼ã‚·ãƒ§ãƒ³", "è–ãªã‚‹ãƒãƒ¼ã‚·ãƒ§ãƒ³", "ç–«æ¯’ã®ãƒãƒ¼ã‚·ãƒ§ãƒ³", "ãƒãƒŠãƒãƒ¼ã‚·ãƒ§ãƒ³", "ç¡¬è‚Œã®ãƒãƒ¼ã‚·ãƒ§ãƒ³", "ãƒ˜ãƒ«ã‚¹ãƒãƒ¼ã‚·ãƒ§ãƒ³"] },
            { group: "å¼±ã„ã‚¹ã‚­ãƒ«", words: ["ã‚‚ã£ã¨åŠ›ã‚’ï¼", "ãƒ•ã‚©ãƒ«ãƒˆã‚¥ãƒŠã®ã‚­ã‚¹", "ã¡ã‚‡ã£ã¨åŠ›ã‚’ï¼"] }
 ã€€ã€€ã€€ã€€ã€€ã€€{ group: "ãƒãƒ•", words:["ãƒªã‚¸ã‚§ãƒ", "ãƒãƒŠ","ãƒ’ãƒ¼ãƒˆ","æ£˜","å¸è¡€","ã‚¨ãƒ³ãƒ‘ãƒ¯ãƒ¼"] },
            { group:"ãƒ‡ãƒãƒ•", words:["æ¯’","ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰","ãƒ•ãƒªãƒ¼ã‚º"]},
            { group:"ã‚¹ã‚¿ãƒ³", words:["ãƒãƒ³ãƒãƒ¼", "ãƒ‘ãƒ³ãƒ—ã‚­ãƒ³", "é»’ã‚¯ã‚¤ãƒ¼ãƒ³", "ãƒ–ãƒ©ã‚¹ãƒŠãƒƒã‚¯ãƒ«", "ãƒ«ãƒ“ãƒ¼ã®ç«ãƒˆã‚«ã‚²", "ã‚¾ã‚¦ã®ãƒ«ãƒ¼ãƒ³", "çˆ†ãœã‚‹èŠæ£˜"]},
            { group: "ãƒ«ãƒ¼ãƒ³", words: ["ã‚¢ãƒŠã‚°ãƒã®ãƒ«ãƒ¼ãƒ³","ã‚¾ã‚¦ã®ãƒ«ãƒ¼ãƒ³","ã‚¿ã‚«ã®ãƒ«ãƒ¼ãƒ³","ãƒˆãƒ©ã®ãƒ«ãƒ¼ãƒ³"]},
            { group: "ç„¡æ•µ", words: ["è¼ã‘ã‚‹ç‹å† ","è¼ãå¤–å¥—","ç‹ã®å† ","ã‚­ãƒ³ã‚°ãƒ»ã‚¹ãƒ©ãƒãƒ¼ãƒˆ","é—‡ã®ãƒ©ãƒ³ã‚¿ãƒ³","ç™½ã®ã‚¯ã‚¤ãƒ¼ãƒ³","ãƒ›ãƒ¼ãƒªãƒ¼ã‚¹ãƒ”ã‚¢"]},
            { group: "â˜†ãŒæ”¾å°„çŠ¶ã«åºƒãŒã‚‹1ãƒã‚¹ã‚¢ã‚¤ãƒ†ãƒ ", words: ["è¶…è¦šé†’","ãƒ¦ã‚°ãƒ‰ãƒ©ã‚·ãƒ«ã®è‘‰","å®‰å®šã—ãŸå†æ§‹ç¯‰å™¨","ãƒ—ãƒªã‚ºãƒ ã‚ªãƒ¼ãƒ–","ç¥ã®å…‰ã‚‚é‡‘æ¬¡ç¬¬","é—‡ã®å„€å¼","åº‡è­·","ã‚½ãƒ©ãƒªã‚¹"]},
            { group: "éŸ³æ¥½ã‚¢ã‚¤ãƒ†ãƒ ", words: ["å¹¸é‹æ³¥æ£’ã®ã‚¢ãƒªã‚¹ã‚¤","ã‚«ãƒ©ã‚¹","æ¥µæ¥½ãƒãƒ¥ãƒ³","ãƒ•ãƒ«ãƒ¼ãƒˆ","ãƒ©ãƒƒãƒ‘","ã‚¢ãƒªã‚¹ã‚¤ã®æ–","ã‚¦ã‚¯ãƒ¬ãƒ¬"]},
            { group: "é§", words: ["è–ãªã‚‹é§","é©ã®é§","çŸ³ã®é§","å¤ªé™½ã®é§","æœˆã®é§","å •è½ã›ã—é§","æ°·ã®é§","ç«œé±—ã®é§","å¾“æ¥­å“¡ã®åˆ¶æœ"]},
            { group: "æ–", words: ["é­”æ³•ã®æ–","æ¯’è›‡ã®æ–","ç¾Šé£¼ã„ã®æ–","ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã®æ–","ç™’ã•ãšã®æ–","ãƒˆã‚²ã®æ–","ç‚ã®æ–","ã‚«ãƒƒãƒ—ã‚±ãƒ¼ã‚­ã®æ–","ã‚¢ãƒªã‚¹ã‚¤ã®æ–"]},
            { group: "ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ã‚’ä»˜ä¸ã§ãã‚‹ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚¢ã‚¤ãƒ†ãƒ ", words: ["ç‡ƒãˆç››ã‚‹æ——å°","è¼ãå¤–å¥—","å‘ªã‚ã‚Œã—ãƒ€ã‚¬ãƒ¼","é—‡ã®ãƒ©ãƒ³ã‚¿ãƒ³"]},
            { group: "ãƒªã‚¸ã‚§ãƒã‚’å–ã‚Œã‚‹ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚¢ã‚¤ãƒ†ãƒ ", words: ["ãƒ¦ã‚°ãƒ‰ãƒ©ã‚·ãƒ«ã®è‘‰","å¤©ç§¤","ç‡ƒãˆç››ã‚‹æ——å°","æ†ãŸã‚‰ã—ã„å¸½å­ãƒ»ãƒãƒ­ãƒ«ãƒ‰","ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªç«","ãƒ‰ãƒ©ã‚´ãƒ³ã®å¯åºŠ","ã‚·ãƒ£ãƒ¼ãƒãƒ³ã®ä»®é¢"]},
            { group: "ãƒ‡ãƒãƒ•ã®è‡ªå·±ä»˜ä¸", words: ["é›ªã®æ£’","ãƒã‚¤ã‚ºãƒ³ã‚¹ãƒ”ã‚¢","é—‡ã®ç‹‚ä¹±","æ°´éŠ€ã®ã‚¨ãƒ¬ãƒ¡ãƒ³ã‚¿ãƒ«","ã‚·ã‚¶ãƒ¼ã‚½ãƒ¼ãƒ‰","ã‚µãƒ³ãƒ‰ãƒãƒƒã‚°å¿"]},
            { group: "çŸ³", words: ["çŸ³","å¤ä»£ã®çŸ³ï¼šãƒ•ãƒªãƒ¼ã‚º","å¤ä»£ã®çŸ³ï¼šãƒ‡ã‚¹","å¤ä»£ã®çŸ³ï¼šãƒ•ãƒ¬ã‚¤ãƒ "]},
            { group: "ãƒãƒ¼ãƒˆ", words: ["ãƒãƒ¼ãƒˆã®å®¹å™¨","æš—é»’ãƒãƒ¼ãƒˆ","ãƒãƒ¼ãƒˆã®ç›¾","æ‹äººã®ã‚«ãƒ¼ãƒ‰","ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªç«", "å½ã‚Šã®å‘½"]},
            { group: "ãƒ‰ãƒ©ã‚´ãƒ³ï¼ˆã‚‚ã©ãå«ã‚€ï¼‰", words: ["ãƒ«ãƒ“ãƒ¼ã®å¹¼ç«œ", "ã‚µãƒ•ã‚¡ã‚¤ã‚¢ã®å¹¼ç«œ", "ã‚¢ãƒ¡ã‚·ã‚¹ãƒˆã®å¹¼ç«œ", "ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã®å¹¼ç«œ", "ãƒ«ãƒ“ãƒ¼ã®ç«ãƒˆã‚«ã‚²", "é»’æ›œã®ãƒ‰ãƒ©ã‚´ãƒ³", "ã‚¢ã‚¤ã‚¹ãƒ‰ãƒ©ã‚´ãƒ³", "ãƒ€ãƒ³ã‚·ãƒ³ã‚°ãƒ‰ãƒ©ã‚´ãƒ³", "ãƒ‰ãƒ©ã‚´ãƒ³ãƒŠã‚¤ãƒˆ"]},
            { group: "ã‚¹ãƒ”ã‚¢", words: ["ã‚¹ãƒ”ã‚¢","ãƒ’ãƒ¼ãƒˆã‚¹ãƒ”ã‚¢","ãƒã‚¤ã‚ºãƒ³ã‚¹ãƒ”ã‚¢","ãƒ›ãƒ¼ãƒªãƒ¼ã‚¹ãƒ”ã‚¢","ãƒ™ãƒªãƒ¼ãƒ­ãƒ³ã‚°ã‚¹ãƒ”ã‚¢"]},
            { group: "ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ", words:  ["ç”Ÿå‘½ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","é‹¼é‰„ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","å¤§é£Ÿã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","æš—é»’ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","æ´»åŠ›ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","é‡ç”Ÿã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","ç§˜è¡“ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","å¹¸ç¦ã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ"]},
            { group: "ä½•ãŒå‡ºã‚‹ã‹ãªï¼Ÿ", words:  ["å®ç®±ï¼ˆã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ©ãƒ¼ï¼‰","ä¾›ç‰©çš¿","æœªé‘‘å®šã®ã‚¢ãƒŸãƒ¥ãƒ¬ãƒƒãƒˆ","ä¸å®‰å®šãªå†æ§‹ç¯‰å™¨","å®‰å®šã—ãŸå†æ§‹ç¯‰å™¨","ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆ","å¯Œã®å®ç®±","å¹¸é‹ã®ãƒ–ã‚¿ã¡ã‚ƒã‚“","ã‚·ãƒ£ãƒ™ãƒ«","ã‚¹ãƒˆãƒ¼ãƒ³ãƒãƒƒã‚¸","æ·±å €","æ–½ã—è¢‹"]},
            { group: "ãƒ–ãƒ¼ãƒ„", words: ["é©ã®ãƒ–ãƒ¼ãƒ„","çŸ³ã®ãƒ–ãƒ¼ãƒ„","ã‚¦ã‚¤ãƒ³ã‚°ãƒ–ãƒ¼ãƒ„","ãƒ‰ãƒ©ã‚´ãƒ³é©ã®ãƒ–ãƒ¼ãƒ„"]},
            { group: "æ‰‹è¢‹", words: ["è¿…é€Ÿã®ã‚°ãƒ­ãƒ¼ãƒ–","å‰›åŠ›ã®ã‚°ãƒ­ãƒ¼ãƒ–","ãƒ‰ãƒ©ã‚´ãƒ³ã‚¯ãƒ­ãƒ¼","å¸è¡€ã®ã‚°ãƒ­ãƒ¼ãƒ–"]}

        ];

        let selectedGroup = null;
        let majorityWord = null;
        let minorityWord = null;
        let wolfPositions = [];
        let discussionInterval = null;

        function startGame() {
            const players = parseInt(document.getElementById('players').value);
            const wolves = parseInt(document.getElementById('wolves').value);
            const myNumber = parseInt(document.getElementById('myNumber').value);

            if (myNumber < 1 || myNumber > players) {
                alert("æ­£ã—ã„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
                return;
            }

            document.getElementById('setup').classList.add('hidden');
            document.getElementById('guide').classList.remove('hidden');
            document.getElementById('timer').classList.remove('hidden');
            document.getElementById('revealBtn').classList.remove('hidden');

            const timerDiv = document.getElementById('timer');
            setInterval(() => {
                const now = new Date();
                timerDiv.textContent = now.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            }, 100);
        }

        function revealWord() {
            const players = parseInt(document.getElementById('players').value);
            const wolves = parseInt(document.getElementById('wolves').value);
            const myNumber = parseInt(document.getElementById('myNumber').value);

                        const now = new Date().getTime();
            const tolerance = 2;
            const roundedTime = Math.floor(now / 1000 / tolerance) * tolerance * 1000;
            let seed = roundedTime + players * 100000 + wolves * 10000;

            function seededRandom() {
                seed = (seed * 16807) % 2147483647;
                return (seed - 1) / 2147483646;
            }

            const groupIndex = Math.floor(seededRandom() * wordGroups.length);
            selectedGroup = wordGroups[groupIndex];

            let words = selectedGroup.words.slice();
            for (let i = words.length - 1; i > 0; i--) {
                const j = Math.floor(seededRandom() * (i + 1));
                [words[i], words[j]] = [words[j], words[i]];
            }

            majorityWord = words[0];
            minorityWord = words[1];

            wolfPositions = [];
            while (wolfPositions.length < wolves) {
                const pos = Math.floor(seededRandom() * players) + 1;
                if (!wolfPositions.includes(pos)) wolfPositions.push(pos);
            }

            const resultDiv = document.getElementById('result');
            resultDiv.classList.remove('hidden');
            resultDiv.innerHTML = '<img src="https://thumb.ac-illust.com/ca/ca19b1b823b60a02eeb8db837fd866db_t.jpeg" class="game-img" alt="ã‹ã‚ã„ã„ç‹¼"><br>';
            if (wolfPositions.includes(myNumber)) {
                resultDiv.innerHTML += `<strong style="color:blue; font-size:48px;">ç´›ã‚Œè¾¼ã‚“ã ç‹¼ã‚’ç‰¹å®šã›ã‚ˆï¼ğŸº</strong><br><br>ãŠé¡Œ: <strong style="font-size:42px;">${minorityWord}</strong>`;
            } else {
                resultDiv.innerHTML += `<strong style="color:blue; font-size:48px;">ç´›ã‚Œè¾¼ã‚“ã ç‹¼ã‚’ç‰¹å®šã›ã‚ˆï¼ğŸº</strong><br><br>ãŠé¡Œ: <strong style="font-size:42px;">${majorityWord}</strong>`;
            }
            resultDiv.innerHTML += `<br><br><small style="font-size:24px;">è­°è«–ã‚¹ã‚¿ãƒ¼ãƒˆï¼ğŸ•’</small>`;

            document.getElementById('revealBtn').classList.add('hidden');
            document.getElementById('timer').classList.add('hidden');
            document.getElementById('guide').classList.add('hidden');

            document.getElementById('discussionTimer').classList.remove('hidden');
            startDiscussionTimer();

            initVoteOptions();
        }

        function startDiscussionTimer() {
            let timeLeft = 180;
            const timerDiv = document.getElementById('discussionTimer');

            discussionInterval = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDiv.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 30) timerDiv.style.color = '#f00';
                if (timeLeft <= 10 && timeLeft > 0) {
                    document.getElementById('beepSound').play();
                }
                if (timeLeft <= 0) {
                    clearInterval(discussionInterval);
                    timerDiv.textContent = "æ™‚é–“çµ‚äº†ï¼æŠ•ç¥¨ã¸";
                    timerDiv.style.color = '#900';
                    document.getElementById('voteSection').classList.remove('hidden');
                    document.getElementById('resultSection').classList.remove('hidden');
                }
                timeLeft--;
            }, 1000);
        }

        function initVoteOptions() {
            const players = parseInt(document.getElementById('players').value);
            const select = document.getElementById('voteTarget');
            select.innerHTML = '';
            for (let i = 1; i <= players; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i}ç•ª`;
                select.appendChild(option);
            }
        }

        function submitVote() {
            const voteTarget = parseInt(document.getElementById('voteTarget').value);
            if (!voteTarget) {
                alert("æŠ•ç¥¨å…ˆã‚’é¸æŠã—ã¦ãã ã•ã„ï¼");
                return;
            }
            document.getElementById('myVote').innerHTML = `<strong style="font-size:28px;">ã‚ãªãŸã®æŠ•ç¥¨: ${voteTarget}ç•ª</strong>`;
            document.querySelector('#voteSection button').disabled = true;
        }

        function showFinalResult() {
            const banished = parseInt(document.getElementById('banished').value);
            if (!banished) {
                alert("è¿½æ”¾è€…ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");
                return;
            }

            const resultDiv = document.getElementById('result');
            const isWolfBanished = wolfPositions.includes(banished);

            if (isWolfBanished) {
                // å¤šæ•°æ´¾å‹åˆ©ï¼ˆã‚¦ãƒ«ãƒ•è¿½æ”¾æˆåŠŸï¼‰ â†’ å°‘æ•°æ´¾ã®ãŠé¡Œå…¬é–‹ + é€†è»¢ãƒãƒ£ãƒ¬ãƒ³ã‚¸å¯èƒ½
                resultDiv.innerHTML += `<br><div class="win">ğŸ‰ å¤šæ•°æ´¾ã®å‹åˆ©ï¼ï¼ˆã‚¦ãƒ«ãƒ•è¿½æ”¾æˆåŠŸï¼‰</div><br>`;
                resultDiv.innerHTML += `<strong style="font-size:36px;">è¿½æ”¾è€… ${banished}ç•ª ã¯ãƒ¯ãƒ¼ãƒ‰ã‚¦ãƒ«ãƒ•ã§ã—ãŸï¼</strong><br><br>`;
                resultDiv.innerHTML += `<strong style="font-size:36px;">ã‚¦ãƒ«ãƒ•ã®ãŠé¡Œã¯ã€Œ${minorityWord}ã€ã§ã—ãŸï¼</strong><br><br>`;
                resultDiv.innerHTML += `<strong style="font-size:32px;">ã‚¦ãƒ«ãƒ•å´ã¯å¤šæ•°æ´¾ã®ãŠé¡Œã‚’å½“ã¦ã¦é€†è»¢ã§ãã¾ã™ï¼</strong><br>`;
                document.getElementById('victorySound').play();

                document.getElementById('reversalBtn').classList.remove('hidden');
            } else {
                // å°‘æ•°æ´¾å‹åˆ©ï¼ˆã‚¦ãƒ«ãƒ•ç”Ÿå­˜ï¼‰ â†’ ãŠé¡Œéå…¬é–‹ã§çµ‚äº†
                resultDiv.innerHTML += `<br><div class="lose">ğŸ˜ˆ å°‘æ•°æ´¾ï¼ˆãƒ¯ãƒ¼ãƒ‰ã‚¦ãƒ«ãƒ•ï¼‰ã®å®Œå…¨å‹åˆ©ï¼ ğŸ˜ˆ</div><br>`;
                resultDiv.innerHTML += `<strong style="font-size:36px;">è¿½æ”¾è€… ${banished}ç•ª ã¯å¤šæ•°æ´¾ã§ã—ãŸ...</strong><br><br>`;
                document.getElementById('loseSound').play();

                document.getElementById('nextGameBtn').classList.remove('hidden');
            }

            resultDiv.innerHTML += `<strong style="font-size:28px;">ãƒ¯ãƒ¼ãƒ‰ã‚¦ãƒ«ãƒ•ã¯ ${wolfPositions.join(', ')}ç•ª ã§ã—ãŸï¼</strong>`;

            document.getElementById('voteSection').classList.add('hidden');
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('discussionTimer').classList.add('hidden');
        }

        function startReversal() {
            document.getElementById('reversalBtn').classList.add('hidden');
            document.getElementById('reversalSection').classList.remove('hidden');
        }

        function checkReversal() {
            const guess = document.getElementById('guessWord').value.trim();
            const resultDiv = document.getElementById('result');

            if (guess === majorityWord) {
                resultDiv.innerHTML += `<br><div class="reversal-win">ğŸ˜ˆ ã‚¦ãƒ«ãƒ•ã®é€†è»¢å‹åˆ©ï¼ï¼ ğŸ˜ˆ</div><br>`;
                resultDiv.innerHTML += `<strong style="font-size:40px;">ã‚¦ãƒ«ãƒ•å´ãŒå¤šæ•°æ´¾ã®ãŠé¡Œã€Œ${majorityWord}ã€ã‚’å½“ã¦ã¾ã—ãŸï¼é€†è»¢æˆåŠŸï¼</strong>`;
                document.getElementById('loseSound').play(); // ã‚¦ãƒ«ãƒ•å‹åˆ©ãªã®ã§loseSound
            } else {
                resultDiv.innerHTML += `<br><div class="win">ğŸ‰ å¤šæ•°æ´¾ã®å®Œå…¨å‹åˆ©ï¼ï¼ ğŸ‰</div><br>`;
                resultDiv.innerHTML += `<strong style="font-size:40px;">é€†è»¢å¤±æ•—...æ­£è§£ã¯ã€Œ${majorityWord}ã€ã§ã—ãŸã€‚å¤šæ•°æ´¾ã®å®Œå…¨å‹åˆ©ï¼</strong>`;
                document.getElementById('victorySound').play();
            }

            document.getElementById('reversalSection').classList.add('hidden');
            document.getElementById('nextGameBtn').classList.remove('hidden');
        }

        function nextGame() {
            if (discussionInterval) clearInterval(discussionInterval);

            document.getElementById('result').classList.add('hidden');
            document.getElementById('result').innerHTML = '';
            document.getElementById('discussionTimer').classList.add('hidden');
            document.getElementById('voteSection').classList.add('hidden');
            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('reversalSection').classList.add('hidden');
            document.getElementById('reversalBtn').classList.add('hidden');
            document.getElementById('nextGameBtn').classList.add('hidden');
            document.getElementById('myVote').innerHTML = '';
            document.getElementById('guessWord').value = '';
            if (document.querySelector('#voteSection button')) {
                document.querySelector('#voteSection button').disabled = false;
            }

            document.getElementById('setup').classList.remove('hidden');
        }
    </script>
</body>
</html>




